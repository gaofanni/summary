# 性能优化

- 减少http请求（最明显）
  - 雪碧图
  - 合并js和css文件
  - 减少http请求头
  - 配置多个域名和cdn加速
  - 使用缓存（http缓存、浏览器缓存、应用缓存）
  - 优化cookie
- html
  - 减少dom数量
  - 减少不必要的嵌套，尽量扁平化，浏览器编译器遇到一个标签时就开始寻找它的结束标签，直到匹配上才显示它的内容，所以嵌套多打开慢
- css
  - 内联首屏关键css：开始页面渲染时间提前，因为html下载完成后就能开始渲染了，但不可太大，因为`初始拥塞窗口`存在限制（tcp相关概念，通常是14.6kb，压缩后大小），如果超出，系统就需要在浏览器和服务器之间进行多次的往返
  - 异步加载css：css会阻塞渲染，在css文件请求、下载、解析完成之前，浏览器不会渲染任何已处理的内容。这种阻塞是必须的，我们不希望在所需css加载之前，浏览器就开始渲染页面。
    - 对于当前模版引擎的开发方式来说，抽出css分文件是为了对cdn缓存保留，避免改变js逻辑导致css的cdn缓存丧失。
  - 有选择的使用选择器
    - 保持简单，不使用嵌套过多的复杂选择器
    - 通配符和属性选择器效率足底，需要匹配的元素最多，避免使用
    - 不要使用类选择器和id选择器修饰元素标签，会降低效率
    - 不要追求速度儿放弃可读性和可维护性
  - 减少使用昂贵的属性：如filter
  - 减少重排和重绘
    - 减少重排
      - 改变font-size和font-family
      - 改变元素内外边距
      - 通过js改变css类
      - 通过js获取dom元素的位置相关属性
      - css伪类激活
      - 滚动滚动条或改变窗口大小
    - 减少重绘
- js
  - 减少全局变量的查找
  - 优化循环
  - 少操作dom
  - 字符串拼接 
- 服务器优化
  - cdn：把网站内容分散到多个，处于不同地域位置的服务器上可以加快下载速度
  - gzip压缩
  - 设置etag，是web服务器和浏览器用于判断浏览器缓存
  - 提前刷新缓存区
- 用户体验
  - 预加载，懒加载
  - 浏览器缓存，应用缓存